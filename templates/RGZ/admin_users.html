

{% extends "base.html" %}
{% block lab %}РГЗ • Админ{% endblock %}

{% block main %}
<section class="rgz">
  <div class="rgz__top">
    <div>
      <h1 class="rgz__title">Админ-панель</h1>
      <p class="rgz__muted">Управление аккаунтами пользователей.</p>
    </div>

    <div class="rgz__actions">
      <a class="btn" href="{{ url_for('rgz.index') }}">На главную</a>
      <a class="btn" href="{{ url_for('rgz.logout') }}">Выход</a>
    </div>
  </div>

  <div class="card">
    <form method="get" class="form form--row">
      <input class="input" type="text" name="q" value="{{ request.args.get('q','') }}" placeholder="Поиск по логину или имени">
      <button class="btn btn--primary" type="submit">Найти</button>
      <a class="btn" href="{{ url_for('rgz.admin_users') }}">Сбросить</a>
    </form>
  </div>

  <div class="card">
    <div class="table-wrap">
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Логин</th>
            <th>Роль</th>
            <th>Имя</th>
            <th>Услуга</th>
            <th>Скрыта</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for u in users %}
            <tr>
              <td>{{ u.id }}</td>
              <td><strong>{{ u.login }}</strong></td>
              <td>{{ u.role }}</td>
              <td>{{ u.name }}</td>
              <td>{{ u.service|capitalize }}</td>
              <td>{% if u.is_hidden %}да{% else %}нет{% endif %}</td>
              <td class="td-actions">
                {% if u.id != user.id %}
                  <form method="post" action="{{ url_for('rgz.admin_user_delete', user_id=u.id) }}"
                        onsubmit="return confirm('Удалить пользователя {{ u.login }}?');">
                    <button class="btn btn--danger" type="submit">Удалить</button>
                  </form>
                {% else %}
                  <span class="rgz__muted">текущий</span>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</section>

<style>
  .rgz { max-width: 1100px; margin: 0 auto; }
  .rgz__top { display:flex; gap:16px; align-items:flex-start; justify-content:space-between; margin-bottom:16px; }
  .rgz__title { margin: 0 0 6px 0; font-size: 28px; }
  .rgz__muted { margin: 0; opacity: .75; }
  .rgz__actions { display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; }

  .card { background:#fff; border:1px solid rgba(0,0,0,.08); border-radius:12px; padding:16px; box-shadow: 0 2px 10px rgba(0,0,0,.04); margin: 14px 0; }

  .form--row { display:flex; gap:10px; flex-wrap:wrap; }
  .input { flex: 1 1 260px; padding:10px 12px; border-radius:10px; border:1px solid rgba(0,0,0,.12); }
  .input:focus { outline:none; border-color: rgba(0,0,0,.35); }

  .btn { display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid rgba(0,0,0,.12); background:#fff; text-decoration:none; color:inherit; cursor:pointer; }
  .btn:hover { border-color: rgba(0,0,0,.25); }
  .btn--primary { background:#111; color:#fff; border-color:#111; }
  .btn--primary:hover { opacity: .92; }
  .btn--danger { background: rgba(220,53,69,.12); border-color: rgba(220,53,69,.35); }
  .btn--danger:hover { border-color: rgba(220,53,69,.55); }

  .table-wrap { overflow:auto; border-radius: 10px; border:1px solid rgba(0,0,0,.08); }
  .table { width:100%; border-collapse: collapse; font-size: 14px; }
  th, td { padding: 10px; border-bottom: 1px solid rgba(0,0,0,.06); text-align:left; }
  th { background: rgba(0,0,0,.03); }
  .td-actions { width: 140px; }

  @media (max-width: 900px) {
    .rgz__top { flex-direction: column; align-items: stretch; }
    .rgz__actions { justify-content:flex-start; }
  }
</style>
{% endblock %}
