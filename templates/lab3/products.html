{% extends "base.html" %}

{% block lab %}–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 3{% endblock %}

{% block main %}
    <h1>–ü–æ–∏—Å–∫ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∏–≥—Ä</h1>

    <form method="GET">
        <div style="display: flex; gap: 20px; align-items: end; margin-bottom: 30px;">
            <div>
                <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:</label><br>
                <input type="number" name="min_price" value="{{ min_price }}" 
                       placeholder="{{ min_all_price }}" min="0" style="width: 150px; padding: 5px;">
            </div>
            
            <div>
                <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:</label><br>
                <input type="number" name="max_price" value="{{ max_price }}" 
                       placeholder="{{ max_all_price }}" min="0" style="width: 150px; padding: 5px;">
            </div>
            
            <div>
                <button type="submit" style="background: #4CAF50; color: white; padding: 8px 16px; border: none; border-radius: 4px;">–ò—Å–∫–∞—Ç—å</button>
                <button type="submit" name="reset" value="1" style="background: #f44336; color: white; padding: 8px 16px; border: none; border-radius: 4px; margin-left: 10px;">–°–±—Ä–æ—Å</button>
            </div>
        </div>
    </form>

    <div style="margin-top: 20px;">
        {% if min_price or max_price %}
            <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</h2>
            <p>–¶–µ–Ω–∞: 
                {% if min_price %}–æ—Ç {{ min_price }} —Ä—É–±{% endif %}
                {% if max_price %}–¥–æ {{ max_price }} —Ä—É–±{% endif %}
            </p>
            <p>–ù–∞–π–¥–µ–Ω–æ –∏–≥—Ä: <strong>{{ filtered_products | length }}</strong></p>
            
            {% if filtered_products %}
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                    {% for product in filtered_products %}
                        <div style="border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <h3 style="margin: 0 0 10px 0; color: #2c5aa0;">{{ product.name }}</h3>
                            <div style="font-size: 24px; color: green; font-weight: bold;">
                                {{ product.price }} —Ä—É–±.
                            </div>
                            <div style="margin-top: 10px; font-size: 14px;">
                                <strong>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:</strong> {{ product.brand }}<br>
                                <strong>–ñ–∞–Ω—Ä:</strong> {{ product.genre }}<br>
                                <strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã:</strong> {{ product.platform }}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div style="text-align: center; padding: 40px; color: #666;">
                    <h3>üéÆ –ù–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–π –∏–≥—Ä—ã</h3>
                    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω</p>
                </div>
            {% endif %}
        {% else %}
            <h2>–í—Å–µ –∏–≥—Ä—ã ({{ products | length }} —à—Ç.)</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                {% for product in products %}
                    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <h3 style="margin: 0 0 10px 0; color: #2c5aa0;">{{ product.name }}</h3>
                        <div style="font-size: 24px; color: green; font-weight: bold;">
                            {{ product.price }} —Ä—É–±.
                        </div>
                        <div style="margin-top: 10px; font-size: 14px;">
                            <strong>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:</strong> {{ product.brand }}<br>
                            <strong>–ñ–∞–Ω—Ä:</strong> {{ product.genre }}<br>
                            <strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã:</strong> {{ product.platform }}
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>

    <div style="margin-top: 30px; padding: 15px; background: #f5f5f5; border-radius: 5px;">
        <p><strong>–î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω:</strong> –æ—Ç {{ min_all_price }} —Ä—É–±. –¥–æ {{ max_all_price }} —Ä—É–±.</p>
        <p><strong>–í—Å–µ–≥–æ –∏–≥—Ä:</strong> {{ products | length }}</p>
    </div>
{% endblock %}